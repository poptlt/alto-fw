---
layout: default
title: YDB
parent: Сервер
nav_order: 2
---

Под концепцию фреймворка использовать Яндекс облако и его serverless сервисы в плане баз данных на данный момент 
подходит только [YDB](https://cloud.yandex.ru/services/ydb). И этот модуль как раз попытка представить простой
и удобный в использовании драйвер этой БД.

Не стоит воспринимать его слишком серьезно, это скорее демонстрация-модель с очень ограниченной функциональностью. Просто сделана небольшая надстройка над [SDK](https://github.com/ydb-platform/ydb-nodejs-sdk) от Яндекса. 
Яндекс обещает через некоторое время представить свой вариант драйвера, сделанный в стиле драйвера для PostgreSQL. 
Надеемся, что он обеспечит необходимую функциональность и, вместе с тем, простоту и удобство использования.

Установка:

> npm install 'https://gitpkg.now.sh/poptlt/alto-fw/server/ydb?master'

Подключение:

> const ydb = require('@alto-fw/ydb')

При инициализации драйвера необходимо передать ему базу данных и параметры сервисного аккаунта, у которого есть необходимые права на эту базу данных.

Сервисному аккаунту нужно дать доступ к БД с ролями **ydb.viewer** и **ydb.editor**

В случае доступа к БД из вне (с локальной машины и т.п.):

> const connect = new ydb(dbName, {serviceAccount: {serviceAccountId, keyId, key}})

, где dbName - имя БД в формате /ru-central1/.........
, serviceAccountId - идентификатор сервисного аккаунта
, keyId - идентификатор авторизованного ключа, созданного для данного сервисного аккаунта
, key - собственно сам ключ

В случае Yandex Cloud Function уже имеем на входе в контексте свежий IAM-токен и параметры сервисного аккаунта не нужны (необходимо только "привязать" сервисный аккаунт к функции, чтобы она имела соответствущие права): 

> const connect = new ydb(dbName, {iamToken: context.token.access_token})